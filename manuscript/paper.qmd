---
title: "Introduction for a BART-Based Model to Predict Chlorophyll-a from Satellite Reflectance"
author: Erdem Karaköylü
date: "2025-04-03"
format:
  pdf:
    documentclass: agujournal2019
    template: templates/agujournaltemplate.tex
    keep-tex: true
bibliography: references.bib
---

### Introduction

#### Historical Context of Chlorophyll Algorithms
Satellite ocean color missions have long relied on empirical spectral algorithms to estimate near-surface chlorophyll-a (Chl-a) concentrations from water‐leaving radiance. NASA’s standard approach since the SeaWiFS era has been the family of “OCx” band‐ratio algorithms, which use blue-to-green reflectance ratios fit to in situ Chl data via polynomial regression [@OReilly2000]. These O’Reilly et al. formulations (e.g., OC4 for SeaWiFS, OC3 for MODIS) became the default global chlorophyll algorithms for multiple sensors due to their relative simplicity and consistency in Case-1 waters. In 2014, NASA introduced the Ocean Color Index (OCI) algorithm, a hybrid empirical model that blends a three‐band reflectance difference method for low‐Chl regimes with the traditional OCx ratio approach at higher Chl concentrations [@NASA2014; @NASA_OC4]. This transition from pure band ratios to a band-difference (baseline subtraction) technique was motivated by the need for improved cross-sensor consistency and better performance in oligotrophic waters. Notably, the color‐index method (CI; Hu et al., 2012) was found to be far less sensitive to instrument noise and atmospheric correction errors than the band‐ratio algorithms. As a result, the OCI approach yields smoother, more stable chlorophyll retrievals in low‐Chl oceans, reducing spurious spatial variability and achieving closer agreement between sensors (SeaWiFS, MODIS, VIIRS) [@hu2019improving].

#### Limitations of Existing Approaches
Despite their empirical success, the existing chlorophyll algorithms have fundamental statistical limitations. The regression procedure underpinning OCx algorithms effectively optimizes the relationship in a forward sense – maximizing the likelihood of the observed reflectance given a chlorophyll value $p(Rrs | Chl)$ – rather than solving the inverse problem of interest $p(Chl | Rrs)$. In practice, the coefficients are tuned to reproduce the sample data distribution, which can lead to overfitting the calibration dataset and biased retrievals when applied broadly. Moreover, uncertainty quantification in these algorithms is ad hoc at best; they provide a point estimate of Chl-a with empirically derived error bounds, but no rigorous probabilistic measure of confidence for each prediction. Another drawback is the use of high-order polynomial fits in the OCx formulations that, while flexible, reduce the interpretability of the model’s spectral response. For example, the standard OC4 algorithm expresses log-transformed Chl-a as a fourth-degree polynomial function of a blue/green reflectance ratio [@OReilly2000]. Such complex polynomial relationships make it difficult to discern how any single band influences the chlorophyll estimate, obscuring physical insights. In summary, current empirical algorithms are not formulated for optimal inference and transparency: they are calibrated to mimic data rather than to robustly infer chlorophyll from reflectance, and they lack a formal mechanism to provide per-observation uncertainty or mechanistic interpretation of the spectral inputs.

#### Motivation for Bayesian Tree-Based Models
To address these limitations, we explore Bayesian tree-based modeling – specifically, Bayesian Additive Regression Trees (BART) – as a novel approach for ocean color chlorophyll retrieval. BART offers several advantages for this application:

Direct Bayesian inference: As a Bayesian ensemble method, BART directly targets the posterior distribution $p(Chl | Rrs)$ rather than a purely empirical fit. The model inherently provides a probabilistic mapping from reflectance to chlorophyll. Rather than producing a single best-fit value, BART returns a posterior mean and credible interval for each prediction, naturally quantifying predictive uncertainty.

Uncertainty quantification: The BART framework includes uncertainty in its predictions by design. Every estimated chlorophyll value comes with a confidence range (e.g., 95% credible interval) reflecting model uncertainty and observational noise. This is a key improvement over deterministic algorithms, enabling more reliable use of the data for scientific and operational purposes where understanding uncertainty is crucial e.g. for forecasting trends.

Interpretability: Being a sum-of-trees model, BART can be interrogated to understand the influence of each input variable. Tools such as partial dependence plots allow us to visualize the relationship between each spectral band and the predicted chlorophyll, marginalizing over other bands. In contrast to high-order polynomial coefficients, these tree-based partial dependencies are intuitively interpretable. For instance, one can observe how changes in a particular waveband’s reflectance (holding others average) drive the chlorophyll estimate, revealing any thresholds or non-linear responses.

BART’s modeling approach is non-parametric and highly flexible, which means it can capture complex, non-linear relationships between multi-spectral Rrs inputs and chlorophyll without imposing a rigid functional form. At the same time, its Bayesian regularization – which shrinks the contribution of each individual tree – helps prevent overfitting even with a rich model structure. This balance between flexibility and regularization is well-suited to global ocean color data, where the true Rrs–Chl relationship is known to be non-linear and context-dependent, yet a model must generalize across diverse water types.

The interpretability of the BART model is illustrated by partial dependence analysis on the six input Rrs bands (centered approximately at 412, 443, 490, 510, 555, and 670 nm). The partial dependence plots reveal nuanced spectral–chlorophyll relationships and clear transitions in the dominant wavelength influence across different chlorophyll regimes. For example, the shorter blue wavelengths (412–443 nm) show a strong inverse influence on predicted $log(Chl_a)$ (higher blue reflectance corresponds to lower chlorophyll) that gradually saturates in the most oligotrophic waters, consistent with the leveling off of blue-to-green ratios at very low Chl. The green band (~555 nm) exhibits a more complex, non-monotonic effect: at low reflectance (clear water) its influence on the Chl estimate is minimal, but it becomes increasingly important through intermediate reflectance ranges – reflecting the band-difference signal exploited by the CI algorithm – and then diminishes for very high chlorophyll where green reflectance tends to flatten. In contrast, the red band (~670 nm) has virtually no effect on the model’s predictions until a threshold is reached at elevated chlorophyll concentrations, after which its influence steeply increases. This behavior aligns with optical expectations, since red reflectance is negligible in low-Chl waters but rises sharply once phytoplankton absorption in the blue saturates and biomass is high. These partial dependence results indicate that the BART model automatically learns the piecewise spectral logic that oceanographers often handle via separate algorithms (blue/green ratios for low-to-moderate Chl, red bands for high Chl). The ability to capture such regime-dependent responses in a single unified model, and to visualize them, underscores the interpretability and scientific insight provided by the BART approach.

Statement of Contribution
In this study, we develop and demonstrate a new global chlorophyll retrieval model based on Bayesian Additive Regression Trees implemented in PyMC. We train the BART model on a large, standardized dataset of satellite remote-sensing reflectance (Rrs) spectra matched with in situ chlorophyll measurements, using log₁₀-transformed Chl-a as the response to stabilize variance. The resulting model is applied globally to produce chlorophyll-a estimates from multi-spectral satellite data, with associated uncertainty estimates for each prediction. We show that this Bayesian tree-based model can serve as a general-purpose ocean color algorithm that is sensor-agnostic (provided reflectances are harmonized to common wavebands), interpretable, and uncertainty-aware. Unlike conventional empirical algorithms, the BART approach allows users to examine the inferred Rrs–Chl relationships and trust the model’s performance across regimes, while also quantifying confidence in each retrieval. This work thus contributes a novel methodological advance to satellite ocean color science: a unified chlorophyll retrieval model that marries the strengths of empirical algorithms (global applicability and simplicity) with the benefits of modern Bayesian machine learning (flexibility, interpretability, and rigorous uncertainty quantification). Our introduction of BART for global chlorophyll prediction opens the door for more robust monitoring of ocean biogeochemistry and improved integration of ocean color data into scientific and management applications.