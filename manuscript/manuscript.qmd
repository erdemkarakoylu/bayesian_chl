---
title: "Shifting paradigms in Ocean Color: Bayesian Inference for Uncertainty-Aware Chlorophyll Estimation "
format:
    agu-pdf:
        keep-tex: true
    agu-html: default
author:  
  - name: Erdem M. Karaköylü
    orcid: 0000-0002-6156-1720
    corresponding: true
    email: erdemk@protonmail.com
    roles:
      - Investigation
      - Software
      - Visualization
    affiliations:
      - Consultant
  - name: Susanne E. Craig
    orcid: 0000-0002-8963-0951
    corresponding: false
    email: susanne.e.craig@nasa.gov
    roles:
      - Investigation
      - Project administration
    affiliations:
      - NASA
abstract: Placeholder
plain-language-summary: Placeholder
keywords: []
key-points:
  - Key Points convey the main points and conclusions of the article. 
  - Up to three key point statements are allowed, and each is limited to at most 140 characters with no abbreviations.
  - Key Points are not included in the word count.
bibliography: references.bib
citation:
  container-title: Geophysical Research Letters
keep-tex: true
date: last-modified
---

### Introduction

#### Historical Context of Chlorophyll Algorithms
Satellite ocean color observations have long been fundamental for monitoring marine ecosystems, as they enable the global estimation of chlorophyll‑a ($Chl_a$) —a key indicator of phytoplankton biomass and ocean productivity. Early empirical algorithms, notably developed by O’Reilly et al. [@oreilly1998; @oreilly2000], established the $OCx$ family (where $x$ denotes the number of bands used) of polynomial regression models. These models relate blue-to-green reflectance ratios (after log‑transformation) to in situ $Chl_a$, employing either straight band ratios (BR) or maximum band ratios (MBR)—the latter selecting the highest available blue-to-green ratio for any given observation as input to a high‑order polynomial. These formulations have served as the operational foundation for chlorophyll‑a products across a broad range of satellite ocean color sensors—from the pioneering Coastal Zone Color Scanner (CZCS) through SeaWiFS, MODIS, and MERIS to more recent missions—offering a straightforward and robust approach for Case‑1 waters. However, their performance is more limited in optically complex Case‑2 waters and remains sensitive to atmospheric correction errors.

Subsequent refinements were introduced to address these deficiencies. For example, Hu et al. [@hu2012novel] proposed a Color Index (CI) formulation that employs a band‑difference approach to reduce sensitivity to residual atmospheric errors and instrument noise, with further improvements enhancing inter‑sensor agreement [@hu2019improving]. The increasing availability of calibration data (e.g., [@Valente2015]) and ongoing algorithmic improvements have led to the development of additional variants of the $OCx$ algorithms—specifically, the OC5 and OC6 formulations. O’Reilly and Werdell [@oreilly2019] maintain that OC5 extends the spectral basis by incorporating the 412 nm band, thereby exploiting its strong signal in clear, oligotrophic waters, while OC6 replaces the traditional denominator with the mean of the 555 and 670 nm reflectances, with the aim of improving the dynamic range at low chlorophyll concentrations. In total, [@oreilly2019] propose 65 versions of BR/MBR $OCx$ type algorithms for 25 sensors—on average, two or more variants per sensor. With this arsenal, it is hoped, researchers are better equipped to address the wide array of bio‑optical environments encountered in global ocean color applications.

#### Limitations of Existing Approaches
Regrettably, the development of traditional ocean color predictive models relies on a fundamental statistical error that plagues most of observational science today; that of conflating sampling probability, with inferential probability. Consider data $D$ that include predictive features (e.g. Remote sensing reflectance - Rrs) and prediction targets (e.g. $Chl_a$ or phytoplankton absorption), and a model $M$ (e.g. OCx) hypothesized to adequately represent the statistical association between the two. The sampling probability $p(D|M)$ also referred to as the likelihood, is the probability of $D$ conditioned on $M$ being "true". The common model fitting practice is to maximize $p(D|M)$ - likelihood maximization - achieved by tuning $M$'s parameters. The unspoken assumption is that making $M$ fit $D$ as well as possible yields the best version of $M$ given $D$ i.e.  maximizing $p(M|D)$, the inferential probability. This sneaky swapping from $p(D|M)$ to $p(M|D)$ is a violation of the rules of conditional probability, Bayes' theorem in particular. Jaynes[@jaynes2003] and later Clayton through his highly readable account [@clayton] are some of the more notable whistleblowers. Occasionally, in simple  or well-behaved problems, with a large amount of data and no prior information available the maxima of both $p(M|D)$ and $p(D|M)$ can indeed converge on the same answer. Yet there is no guarantee predictability for this outcome however, and the fallout of this abuse is non-negligible, most noticeably in terms of models that don't generalize well, ad-hoc uncertainty estimation attempts, and more broadly a replication crisis. 

Some researchers have attempted to deal with these issues. [@seegers2018] e.g. have proposed alternative metrics to circumvent the inadequate assumptions of the frequentist approach. Others have tried to go a step futher and switch to the Bayesian paradigm. E.g. [ @frouin2013] have proposed a Bayesian inversion scheme for atmospheric correction. [@shi2015] proposed a probabilistic method to merge data from different sensors. [@craig2019] have proposed a Bayesian neural network approach using Hamiltonian Monte Carlo sampling to retrieve Inherent Optical Properties (IOP) from Top-of-the-atmosphere (TOA) radiance. [@werther2022] used Monte-Carlo dropout as deep neural net training method to obtain prediction uncertainty. [@erickson2023] have proposed using conjugate Gaussian prior and likelihood to predict IOPs using GIOP as a forward model. [@hammout2024] have proposed a Bayesian Neural Network trained using Stochastic Variational Inference to predict $Chl_a$ from ocean color observations. Yet most of these approaches retain variable levels of frequentism by applying only part of what is commonly referred to as the Bayesian workflow[@betancourt2019].

In this paper we propose a modified workflow to Bayesian modeling for Ocean Color emote sensing. We propose that this workflow include; (1) one or more model building, (2) prior formulation via expert knowledge elicitation and/or data-free simulation, (3) fitting model to data, (4) model validation, comparison and selection, (5) interpretation of results via posterior analysis, (6) prediction on new observation, (7) update the posterior when new labeled data becomes available. As illustration we recast some of the pre-existing $OCx$ models into their probabilistic version. To illustrate model comparison and selection we also build and evaluate Bayesian Additive Tree Regregssion  (BART; [@chipman2010bart]) type model. 



### Methods

#### Prior Elicitation and Model Formulation

#### Data Preprocessing

#### 



\section{Data Preprocessing}

Data for this study were acquired from multiple satellite ocean color sensors and corresponding in situ chlorophyll-\(a\) measurements obtained from sources such as the NASA Bio-Optical Marine Algorithm Data set (NOMAD) and the compilation by Valente et al. (2015). To ensure consistency across sensors, the spectral reflectance data (\(R_{rs}\)) were interpolated as needed to common wavelength centers.

For the empirical \(OCx\) formulation, blue-to-green band ratios were computed for each observation. In particular, the maximum band ratio (MBR) was determined by taking the highest value among the available blue-band ratios (e.g., \(Rrs(443)/Rrs(555)\), \(Rrs(490)/Rrs(555)\), and \(Rrs(510)/Rrs(555)\)). This maximum value was then log-transformed:
$$
\log R = \log_{10}\left(\frac{R_{rs}(\lambda_{\text{blue}})}{R_{rs}(555)}\right).
$$

For the Color Index (CI) formulation of Hu et al. (2012), the CI was calculated as:
$$
\text{CI} = R_{rs}(555) - \left[\,R_{rs}(443) + \frac{555-443}{670-443}\Bigl(R_{rs}(670) - R_{rs}(443)\Bigr)\,\right],
$$
and the corresponding in situ chlorophyll-\(a\) concentrations were log-transformed:
$$
\log \text{Chl} = \log_{10}(\text{Chl}).
$$

These transformations standardize the data to a common scale, ensuring that variability is appropriately captured for subsequent regression and uncertainty quantification. Detailed descriptions of the interpolation methods and quality control procedures are provided in the Supplementary Material.


## Statement of Contribution
In this study, we develop and demonstrate a new global chlorophyll retrieval model based on Bayesian Additive Regression Trees implemented in PyMC. We train the BART model on a large, standardized dataset of satellite remote-sensing reflectance (Rrs) spectra matched with in situ chlorophyll measurements, using log₁₀-transformed Chl-a as the response to stabilize variance. The resulting model is applied globally to produce chlorophyll-a estimates from multi-spectral satellite data, with associated uncertainty estimates for each prediction. We show that this Bayesian tree-based model can serve as a general-purpose ocean color algorithm that is sensor-agnostic (provided reflectances are harmonized to common wavebands), interpretable, and uncertainty-aware. Unlike conventional empirical algorithms, the BART approach allows users to examine the inferred Rrs–Chl relationships and trust the model’s performance across regimes, while also quantifying confidence in each retrieval. This work thus contributes a novel methodological advance to satellite ocean color science: a unified chlorophyll retrieval model that marries the strengths of empirical algorithms (global applicability and simplicity) with the benefits of modern Bayesian machine learning (flexibility, interpretability, and rigorous uncertainty quantification). Our introduction of BART for global chlorophyll prediction opens the door for more robust monitoring of ocean biogeochemistry and improved integration of ocean color data into scientific and management applications.


## Acknowledgments

## Open research

## References {.unnumbered}

:::{#refs}

:::